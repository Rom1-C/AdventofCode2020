Only part1, part2 is too hard for now. It's ugly but it works and I tried to make function but that destroyed the result.
